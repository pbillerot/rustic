{%- extends "tpl_base.html" -%}
{% import "tpl_list_elements.html" as macros %}

{%- block title -%}
<span>&nbsp;<b>{{ application.title }}</b></span>
{%- endblock -%}

{%- block menu -%}
{%- for tv in application.menu -%}
<li><a
    href="/list/{{appid}}/{{tv.tableid}}/{{tv.viewid}}">{{application.tables[tv.tableid].views[tv.viewid].title}}</a>
</li>
{%- endfor -%}
{%- endblock -%}

{%- block content -%}
<h1>{{view.title}}</h1>
<table>
  <tr>
    {%- for el in view.velements -%}
    {%- if view.form_view or view.form_edit -%}<th></th>{%- endif -%}
    <th>{{el.label_short}}</th>
    {%- endfor -%}
  </tr>
  {%- for record in records %}
  <tr>
    {%- if view.form_view -%}
    <td><a href="/view/{{appid}}/{{tableid}}/{{viewid}}/{{view.form_view}}/{{record[application.tables[tableid].setting.key].key_value}}" title="Visualier">[V]</a></td>
    {%- elif view.form_edit -%}
    <td><a href="/edit/{{appid}}/{{tableid}}/{{viewid}}/{{view.form_edit}}/{{record[application.tables[tableid].setting.key].key_value}}" title="Ã‰diter">[E]</a></td>
    {%- endif -%}
    {%- for vel in view.velements -%}
      {{ macros::list_elements(el=record[vel.elid]) }}
    {%- endfor -%}
  </tr>
  {%- endfor -%}
</table>
{%- endblock -%}
{%- block actions -%}
{%- for action in application.tables[tableid].views[viewid].actions -%}
<li><a href="">{{ action.label }}</a></li>
{%- endfor -%}
{%- endblock -%}
